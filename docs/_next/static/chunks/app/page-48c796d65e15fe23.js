(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1608:function(e,t,r){Promise.resolve().then(r.bind(r,7537))},7537:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var n=r(7437),s=r(2265),a=r(5293),o=r(7712),l=r(1994),i=r(3335);function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.m6)((0,l.W)(t))}let c=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:l=!1,...i}=e,u=l?a.g7:"button";return(0,n.jsx)(u,{className:d(c({variant:s,size:o,className:r})),ref:t,...i})});u.displayName="Button";let f=s.forwardRef((e,t)=>{let{className:r,type:s,...a}=e;return(0,n.jsx)("input",{type:s,className:d("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});f.displayName="Input";let p=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("textarea",{className:d("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});p.displayName="Textarea";let m=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:d("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});m.displayName="Card";let g=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:d("flex flex-col space-y-1.5 p-6",r),...s})});g.displayName="CardHeader";let x=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("h3",{ref:t,className:d("text-2xl font-semibold leading-none tracking-tight",r),...s})});x.displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("p",{ref:t,className:d("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription";let v=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:d("p-6 pt-0",r),...s})});v.displayName="CardContent";let b=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:d("flex items-center p-6 pt-0",r),...s})});b.displayName="CardFooter";var h=r(1107);let y=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),N=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(h.f,{ref:t,className:d(y(),r),...s})});N.displayName=h.f.displayName;let j=(0,o.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),w=s.forwardRef((e,t)=>{let{className:r,variant:s,...a}=e;return(0,n.jsx)("div",{ref:t,role:"alert",className:d(j({variant:s}),r),...a})});w.displayName="Alert",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("h5",{ref:t,className:d("mb-1 font-medium leading-none tracking-tight",r),...s})}).displayName="AlertTitle";let A=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:d("text-sm [&_p]:leading-relaxed",r),...s})});A.displayName="AlertDescription";var C=r(201),S=r(2735);function R(e){return e=(e=e.replace(/"/g,'""')).replace(/\r\n|\n|\r/g,'" & vbCrLf & "')}function k(){let[e,t]=(0,s.useState)(""),[r,a]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[i,d]=(0,s.useState)(""),[c,h]=(0,s.useState)(""),y=async()=>{let e=await fetch("https://raw.githubusercontent.com/VBA-tools/VBA-JSON/refs/heads/master/JsonConverter.bas"),t=await e.blob(),n=new Blob([i],{type:"text/plain"}),s=(e,t)=>{let r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)};s(n,"".concat(r||"OpenAIModule",".bas")),s(t,"JsonConverter.bas")},j=e=>/^[a-zA-Z0-9_]+$/.test(e)?(h(""),!0):(h("関数名には英数字、アンダースコア、スペースのみ使用できます。"),!1);return(0,n.jsxs)(m,{className:"w-full max-w-2xl mx-auto",children:[(0,n.jsx)(g,{children:(0,n.jsx)(x,{children:"VBAスクリプトジェネレーター"})}),(0,n.jsxs)(v,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(N,{htmlFor:"apiKey",children:"APIキー"}),(0,n.jsx)(f,{id:"apiKey",value:e,onChange:e=>t(e.target.value),placeholder:"sk-..."})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(N,{htmlFor:"functionName",children:"関数名"}),(0,n.jsx)(f,{id:"functionName",value:r,onChange:e=>{let t=e.target.value;a(t),j(t)},placeholder:"CallOpenAI","aria-invalid":c?"true":"false","aria-describedby":c?"functionName-error":void 0}),c&&(0,n.jsx)(w,{variant:"destructive",children:(0,n.jsx)(A,{id:"functionName-error",children:c})})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(N,{htmlFor:"systemPrompt",children:"システムプロンプト"}),(0,n.jsx)(p,{id:"systemPrompt",value:o,onChange:e=>l(e.target.value),placeholder:"あなたは優秀なアシスタントです。",rows:3})]}),(0,n.jsx)(u,{onClick:()=>{let t=R(r),n=R(o),s=R(e);d("\n\nFunction ".concat(t,"(prompt As String) As String\n    On Error GoTo ErrorHandler ' エラーハンドリングの設定\n    Dim xmlHttp As Object\n    Dim url As String\n    Dim apiKey As String\n    Dim data As String\n    Dim response As String\n    Dim json As Object\n    \n    ' OpenAI APIのエンドポイントURL\n    url = \"https://api.openai.com/v1/chat/completions\"\n    \n    ' OpenAI APIキー（ここにあなたのAPIキーを設定）\n    apiKey = \"").concat(s,'"\n\n    \' プロンプト内の特殊文字をエスケープ\n    prompt = Replace(prompt, "", "\\")\n    prompt = Replace(prompt, """", """")\n    \n    \' APIに送信するJSON形式のデータ\n    data = "{""model"":""gpt-4"",""messages"":[{""role"":""system"",""content"":""').concat(n,'""},{""role"":""user"",""content"":""" & prompt & """}]}"\n    \n    \' XMLHTTPオブジェクトの作成\n    Set xmlHttp = CreateObject("MSXML2.XMLHTTP")\n    \n    \' HTTP POSTリクエストを初期化\n    xmlHttp.Open "POST", url, False\n    \n    \' リクエストヘッダーの設定（APIキーとContent-Type）\n    xmlHttp.setRequestHeader "Authorization", "Bearer " & apiKey\n    xmlHttp.setRequestHeader "Content-Type", "application/json"\n    \n    \' リクエストを送信（データも送信）\n    xmlHttp.Send data\n    \n    \' レスポンスを変数に保存\n    response = xmlHttp.ResponseText\n    \n    \' 即時ウィンドウにレスポンスを出力（デバッグ用）\n    Debug.Print "API Response: " & response\n    \n    \' JSONレスポンスを解析するために、JSONオブジェクトを取得\n    Set json = JsonConverter.ParseJson(response)\n    \n    \' 即時ウィンドウに解析後のJSONを出力（デバッグ用）\n    Debug.Print "Parsed JSON: " & json("choices")(1)("message")("content")\n    \n    \' レスポンスから生成されたテキストを取得\n    ChatCompletion = json("choices")(1)("message")("content")\n    \n    \' オブジェクトを解放\n    Set xmlHttp = Nothing\n    Set json = Nothing\n    Exit Function\n\nErrorHandler:\n    ChatCompletion = "Error: " & Err.Description\nEnd Function\n\n\n    ').trim())},className:"w-full",disabled:!!c,children:"スクリプト生成"}),i&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(N,{htmlFor:"generatedScript",children:"生成されたVBAスクリプト"}),(0,n.jsx)(p,{id:"generatedScript",value:i,readOnly:!0,rows:10,className:"font-mono text-sm"})]})]}),i&&(0,n.jsxs)(b,{className:"flex flex-col sm:flex-row gap-2",children:[(0,n.jsxs)(u,{onClick:()=>{navigator.clipboard.writeText(i).then(()=>alert("スクリプトがクリップボードにコピーされました！")).catch(e=>console.error("コピーに失敗しました:",e))},className:"w-full sm:w-1/2",children:[(0,n.jsx)(C.Z,{className:"mr-2 h-4 w-4"}),"クリップボードにコピー"]}),(0,n.jsxs)(u,{onClick:y,className:"w-full sm:w-1/2",children:[(0,n.jsx)(S.Z,{className:"mr-2 h-4 w-4"}),"VBAファイルをダウンロード"]})]})]})}}},function(e){e.O(0,[530,971,117,744],function(){return e(e.s=1608)}),_N_E=e.O()}]);